<!DOCTYPE html>
<html>
<head>
  <!-- Authors: Robert Max Williams and Luke Harold Miles. Public Domain Dedication. -->
  <meta charset="utf-8">
  <title>Laser Cubes Future Chat</title>
  <style>
  body {margin: 0; padding: 0;}
  canvas {width: 100%; height: 100%;}
  </style>
</head>
<body>
<video id="_webcam" style="display: none;" playsinline></video> <!-- Invisibly holds webcam input -->
<div style="position:relative" id="webgl-container"> <!-- Holds webgl rendering of cube universe -->
  <div style="position:absolute;outline: 2px solid green; width:200px; top:0px; right:0px;" id="webcam-container">
    <canvas id="_imageData" style="width:200px; height:200px;"></canvas> <!-- Holds webcam + facial map overlay -->
  </div>
</div>
<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>

<script>
var faces = [{points:{0:{x:0,y:0},14:{x:100,y:100},62:{x:0,y:0}}}]; // default temporary value
var x0 = 0, y0 = 0; // the '0-point' for the webcam feed nose tip
var xsign=1, ysign=1; // for mirroring direction of rotation

(function() {
  var c = document.getElementById("webcam-container");

  var set0 = document.createElement("button");
  set0.innerText = "Set 0 point for nose";
  set0.onclick = function () {
    var point = faces[0].points[62];
    [x0, y0] = [point.x, point.y];
  };
  set0.style.fontSize = "20px";
  c.appendChild(set0);

  var mirrorx = document.createElement("button");
  mirrorx.innerText = "Mirror left/right";
  mirrorx.onclick = function() { xsign *= -1; };
  mirrorx.style.fontSize = "20px";
  c.appendChild(mirrorx);

  var mirrory = document.createElement("button");
  mirrory.innerText = "Mirror up/down";
  mirrory.onclick = function() { ysign *= -1; };
  mirrory.style.fontSize = "20px";
  c.appendChild(mirrory);
})();
</script>

<script src="three.min.js"></script> <!-- WebGL wrapper -->
<script src="cubes.js"> </script> <!-- Displays interactive cube environment -->

<script async src="js/libs/brf_asmjs/BRFv4_JS_TK190218_v4.0.5_trial.js"></script> <!-- facial map library -->
<script src="webcam.js"> </script> <!-- use the webcam with the library and display it -->

</body>
</html>
